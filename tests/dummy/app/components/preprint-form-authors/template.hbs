<div class="row">
    <div class="col-xs-12 col-sm-6">
        <div class="row">
            <div class="col-xs-8 col-xs-offset-2">
                <form {{action 'findContributors' on='submit'}}>
                    <div class="input-group search-box">
                        <input type="text" class="form-control input-lg" onchange={{action "updateQuery" value="target.value"}} placeholder="Search by name">
                        <span class="input-group-btn">
                            <button class="btn btn-default btn-lg" type="button" {{action 'findContributors'}} >
                                <i class="glyphicon glyphicon-search"></i>
                            </button>
                        </span>
                    </div>
                </form>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-8 col-xs-offset-2">
                {{#if searched}}
                    <div class="unregisteredUsers">
                        <p> Can't find the user you're looking for? </p>
                        <button class="btn btn-primary btn-small"> Add an unregistered user </button>
                    </div>
                    <h3> Results </h3>
                    {{#if searchResults}}
                        <table class="table">
                            {{#each searchResults as |result|}}
                                {{#if (not (userContributor result contributors))}}
                                    <tr>
                                        <td>
                                            <img class="m-l-xs" src={{result.links.profile_image}} height=40 width=40>
                                            <a href={{result.links.html}}> {{result.fullName}} </a>

                                        </td>
                                        <td> <button class="btn btn-success btn-small" {{action "addContributor" result}}> Add </button> </td>
                                    </tr>
                                {{/if}}
                            {{/each}}
                        </table>
                    {{else}}
                        No results found.
                    {{/if}}
                {{/if}}
            </div>
        </div>
    </div>
    <div class="col-xs-12 col-sm-6 col-division-left">
        <h2> Authors </h2>
        <p class="small"> Preprint must have at least one registered administrator and one author included in the citation. </p>
        <div class="panel-body">
            <table class="table">
                <tr>
                    <th> </th>
                    <th> Name </th>
                    <th> Permissions </th>
                    <th class="bib-padding"> In Citation </th>
                    <th> </th>
                </tr>
                {{#each contributors as |contrib|}}
                    <tr class="contributor-row">
                        <td> <span class="fa fa-bars sortable-bars"></span> </td>
                        <td>
                            <img class="m-l-xs" src={{contrib.users.links.profile_image}} height=40 width=40>
                            {{#if contrib.unregisteredContributor}}
                                {{contrib.unregisteredContributor}}
                            {{else}}
                                <a href={{contrib.users.links.html}}> {{contrib.users.fullName}} </a>
                            {{/if}}
                        </td>
                        <td class="vert-align">
                            <div class="form-group">
                                {{#if (and stillAdmin (and canEdit (minAdmins contrib contributors permissionToggle)))}}
                                    <select class="form-control" onchange={{action (action 'updatePermissions' contrib) value='target.value'}}>
                                        <option value=READ selected={{eq contrib.permission 'read'}}> Read </option>
                                        <option value=WRITE selected={{eq contrib.permission 'write'}}> Read + Write </option>
                                        <option value=ADMIN selected={{eq contrib.permission 'admin'}}> Administrator </option>
                                    </select>
                                {{else}}
                                    <span> {{permissionMap contrib.permission}} </span>
                                {{/if}}
                            </div>
                        </td>
                        <td class="bib-padding">
                            <input disabled={{if (and stillAdmin (and canEdit (minBibliographic contrib contributors bibliographicToggle))) false true}} onchange={{action (action 'updateBibliographic' contrib) value='target.checked'}} checked={{eq contrib.bibliographic true}} type="checkbox" name="bibliographic">
                        </td>
                        <td>
                            {{#if (and (permissionToRemoveContributor contrib currentUser stillAdmin node) (conditionsForContribRemoval contrib contributors removalToggle))}}
                                <button {{action 'removeContributor' contrib}} class="btn btn-danger btn-sm"> Remove </button>
                            {{else}}
                                <button class="btn btn-danger btn-sm disabled"> Remove </button>
                            {{/if}}
                        </td>
                    </tr>
                {{/each}}
            </table>
        </div>
    </div>
</div>
